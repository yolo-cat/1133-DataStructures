# 運算符優先順序表 (Operator Precedence Table)

## 優先級定義
數字越大，優先級越高

| 優先級 | 運算符 | 名稱 | 結合性 | 說明 |
|--------|--------|------|--------|------|
| 5 | `²` | 平方/指數 | 右結合 | 最高優先級 |
| 4 | `+` (正號), `-` (負號) | 一元運算符 | 右結合 | 單項運算符 |
| 3 | `*`, `/`, `%` | 乘除運算 | 左結合 | 乘法、除法、取餘 |
| 2 | `+`, `-` | 加減運算 | 左結合 | 二元加法、減法 |
| 1 | `(`, `)` | 括號 | - | 改變運算順序 |
| 0 | 其他 | 運算元 | - | 變數、數字 |

## Java 實作範例

```java
// 優先級對照表
public static int getPrecedence(char operator) {
    switch (operator) {
        case '²': return 5;          // 指數運算
        case '*': 
        case '/': 
        case '%': return 3;          // 乘除運算
        case '+': 
        case '-': return 2;          // 加減運算 (二元)
        case '(': return 1;          // 左括號
        case ')': return 1;          // 右括號
        default: return 0;           // 運算元或未知符號
    }
}

// 檢查是否為右結合
public static boolean isRightAssociative(char operator) {
    return operator == '²';  // 只有指數運算是右結合
}
```

## 特殊處理案例

### 1. 負號 vs 減號識別
```
表達式: -a*b-c-(-b)
        ^   ^   ^
        |   |   |
      負號 減號 負號
```

### 2. 括號處理
- `(` : 遇到時直接推入堆疊
- `)` : 彈出運算符直到遇到對應的 `(`

### 3. 指數運算 (右結合)
```
a²² 應該解析為 a^(2²) = a^4
而不是 (a²)² = a^4 (雖然結果相同，但概念不同)
```

## 轉換演算法流程

### 中序轉後序 (Shunting Yard Algorithm)
1. 掃描中序表達式
2. 遇到運算元：直接輸出
3. 遇到運算符：
   - 比較與堆疊頂部運算符的優先級
   - 若當前運算符優先級較低或相等（左結合），彈出堆疊頂部
   - 將當前運算符推入堆疊
4. 遇到 `(`：直接推入堆疊
5. 遇到 `)`：彈出運算符直到遇到 `(`
6. 最後彈出堆疊中所有運算符

### 測試案例預期結果

#### 案例1: `(a+b-c)²*c`
- **中序**: `(a+b-c)²*c`
- **後序**: `a b + c - ² c *`
- **前序**: `* ² - + a b c c`

#### 案例2: `(a+b-c)^2*c`
- **中序**: `(a+b-c)^2*c`
- **後序**: `a b + c - 2 ^ c *`
- **前序**: `* ^ - + a b c 2 c`

#### 案例3: `-a*b-c-(-b)`
- **中序**: `-a*b-c-(-b)`
- **後序**: `a - b * c - b - -`
- **前序**: `- - * - a b c - b`

## 實作注意事項
1. **負號檢測**: 在運算符或 `(` 後面的 `-` 是負號
2. **空白處理**: 忽略空白字符
3. **錯誤處理**: 檢查括號是否匹配
4. **變數名稱**: 支援多字符變數名稱
